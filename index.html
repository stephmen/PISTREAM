<html>

<body>
    <script type="text/javascript" src="https://rawgit.com/131/h264-live-player/master/vendor/dist/http-live-player.js"></script>
    <script>
        const canvas = document.createElement("canvas");
        //document.body.appendChild(canvas);
        //document.querySelector('canvas').style.visibility = "hidden"
        const video = document.createElement("video");
        document.body.appendChild(video);
        //document.querySelector('video').style.visibility = "hidden"
        var canvasD = document.createElement("canvas");
        document.body.appendChild(canvasD).setAttribute("id", "destination");
        //const srcCanvas = document.querySelector('canvas');
        const dstVideo = document.querySelector('video');
        var canvasD = document.querySelector('#destination');
        const ctxD = canvasD.getContext('2d');



        // Streaming to Canvas from Raspberry PI with Express Socket
        const wsavc = new WSAvcPlayer(canvas, "webgl");
        const protocol = window.location.protocol === "http:" ? "ws:" : "ws:"
        wsavc.connect(protocol + '//' + window.location.host + '/video-stream');


        //Video !!!
        // Optional frames per second argument.Better if empty
        // Set the source of the <video> element to be the stream from the <canvas>.
        //Streaming to Canvas
        var stream = canvas.captureStream();
        dstVideo.srcObject = stream;
        dstVideo.play()

        //Streaming to canvas 2D

        function StreamToCanvas2D() {
            const width = video.videoWidth;
            const height =video.videoHeight;

            canvasD.width = width;
            canvasD.height = height;


            setInterval(() => {
                ctxD.drawImage(dstVideo, 0, 0, 640, 480);

            }, 15);
        }

        dstVideo.addEventListener('progress', StreamToCanvas2D);
    </script>

</body>

</html>